#          label = method_name, shape = ellipse) %>%
add_node(paste(class_name, method_name, sep = "_"),
label = method_name) %>%
#  add_edge(class_name, paste(class_name, method_name, sep = "_"))
add_edge(., class_name, label = method_name)
}
}
# Add classes and their methods to the diagram
# for (class_name in names(class_relations)) {
#   graph <- paste(graph, sprintf('  "%s";\n', class_name))  # Add class node
#
#   for (method_name in names(class_relations[[class_name]])) {
#     method_node <- paste(class_name, method_name, sep = "_")
#     graph <- paste(graph, sprintf('  "%s" [shape=ellipse, label="%s"];\n', method_node, method_name))  # Add method node
#     graph <- paste(graph, sprintf('  "%s" -> "%s";\n', class_name, method_node))  # Add edge from class to method
#   }
# }
# Add class relationships
# for (class_name in names(class_relations)) {
#   relations <- class_relations[[class_name]]
#   for (method_name in names(relations)) {
#     for (related_class in relations[[method_name]]) {
#       method_node <- paste(class_name, method_name, sep = "_")
#       graph <- paste(graph, sprintf('  "%s" -> "%s";\n', method_node, related_class))  # Add edge from method to related class
#     }
#   }
# }
graph <- paste(graph, "}")
return(graph)
}
class_diagram <- create_class_diagram(class_relations =class_relations)
for (method_name in names(class_relations[[class_name]])) {
method_name <- method_name
graph <- graph %>%
# add_node(paste(class_name, method_name, sep = "_"),
#          label = method_name, shape = ellipse) %>%
add_node(paste(class_name, method_name, sep = "_"),
label = method_name) %>%
#  add_edge(class_name, paste(class_name, method_name, sep = "_"))
add_edge(., class_name, label = method_name)
}
for (class_name in names(class_relations)) {
for (class_name in names(class_relations)) {
graph <- graph %>%
add_node(class_name, label = class_name)
for (method_name in names(class_relations[[class_name]])) {
method_name <- method_name
graph <- graph %>%
# add_node(paste(class_name, method_name, sep = "_"),
#          label = method_name, shape = ellipse) %>%
add_node(paste(class_name, method_name, sep = "_"),
label = method_name) %>%
#  add_edge(class_name, paste(class_name, method_name, sep = "_"))
add_edge(., class_name, label = method_name)
}
}
graph
)))
# graph <- grViz("digraph G {
#   graph [layout = dot]
#   node [shape = rectangle, style = filled, fillcolor = LightBlue]
#
#   # Klassen und ihre Methoden hinzufügen
#   ")
graph <- create_graph()
for (class_name in names(class_relations)) {
graph <- graph %>%
add_node(class_name, label = class_name)
for (method_name in names(class_relations[[class_name]])) {
method_name <- method_name
graph <- graph %>%
# add_node(paste(class_name, method_name, sep = "_"),
#          label = method_name, shape = ellipse) %>%
add_node(paste(class_name, method_name, sep = "_"),
label = method_name) %>%
#  add_edge(class_name, paste(class_name, method_name, sep = "_"))
add_edge(., class_name, label = method_name)
}
}
# graph <- grViz("digraph G {
#   graph [layout = dot]
#   node [shape = rectangle, style = filled, fillcolor = LightBlue]
#
#   # Klassen und ihre Methoden hinzufügen
#   ")
graph <- create_graph()
# Hinzufügen der Klassen und Methoden zum Diagramm
for (class_name in names(class_relations)) {
graph <- graph %>%
add_node(class_name, label = class_name)
for (method_name in names(class_relations[[class_name]])) {
method_name <- method_name
graph <- graph %>%
# add_node(paste(class_name, method_name, sep = "_"),
#          label = method_name, shape = ellipse) %>%
add_node(paste(class_name, method_name, sep = "_"),
label = method_name) %>%
#  add_edge(class_name, paste(class_name, method_name, sep = "_"))
add_edge(class_name, label = method_name)
}
}
method_name
# graph <- grViz("digraph G {
#   graph [layout = dot]
#   node [shape = rectangle, style = filled, fillcolor = LightBlue]
#
#   # Klassen und ihre Methoden hinzufügen
#   ")
graph <- create_graph()
graph <- graph %>%
add_node(class_name, label = class_name)
method_name <- paste(class_name, method_name, sep = "_")
graph <- graph %>%
# add_node(paste(class_name, method_name, sep = "_"),
#          label = method_name, shape = ellipse) %>%
#  add_edge(class_name, paste(class_name, method_name, sep = "_"))
add_node(method_id, label = method_name, shape = "ellipse") %>%
add_edge(class_name, method_id)  # Connect class to method
for (class_name in names(class_relations)) {
graph <- graph %>%
add_node(class_name, label = class_name)
for (method_name in names(class_relations[[class_name]])) {
method_name <- paste(class_name, method_name, sep = "_")
graph <- graph %>%
# add_node(paste(class_name, method_name, sep = "_"),
#          label = method_name, shape = ellipse) %>%
#  add_edge(class_name, paste(class_name, method_name, sep = "_"))
add_node(method_name, label = method_name, shape = "ellipse") %>%
add_edge(class_name, method_id)  # Connect class to method
}
}
# graph <- grViz("digraph G {
#   graph [layout = dot]
#   node [shape = rectangle, style = filled, fillcolor = LightBlue]
#
#   # Klassen und ihre Methoden hinzufügen
#   ")
graph <- create_graph()
# Hinzufügen der Klassen und Methoden zum Diagramm
for (class_name in names(class_relations)) {
graph <- graph %>%
add_node(class_name, label = class_name)
for (method_name in names(class_relations[[class_name]])) {
method_name <- paste(class_name, method_name, sep = "_")
graph <- graph %>%
# add_node(paste(class_name, method_name, sep = "_"),
#          label = method_name, shape = ellipse) %>%
#  add_edge(class_name, paste(class_name, method_name, sep = "_"))
add_node(method_name, label = method_name, shape = "ellipse") %>%
add_edge(class_name, method_id)  # Connect class to method
}
}
# graph <- grViz("digraph G {
#   graph [layout = dot]
#   node [shape = rectangle, style = filled, fillcolor = LightBlue]
#
#   # Klassen und ihre Methoden hinzufügen
#   ")
graph <- create_graph()
# Hinzufügen der Klassen und Methoden zum Diagramm
for (class_name in names(class_relations)) {
graph <- graph %>%
add_node(class_name, label = class_name)
for (method_name in names(class_relations[[class_name]])) {
method_name <- paste(class_name, method_name, sep = "_")
graph <- graph %>%
# add_node(paste(class_name, method_name, sep = "_"),
#          label = method_name, shape = ellipse) %>%
#  add_edge(class_name, paste(class_name, method_name, sep = "_"))
add_node(method_name, label = method_name) %>%
add_edge(class_name, method_id)  # Connect class to method
}
}
# graph <- grViz("digraph G {
#   graph [layout = dot]
#   node [shape = rectangle, style = filled, fillcolor = LightBlue]
#
#   # Klassen und ihre Methoden hinzufügen
#   ")
graph <- create_graph()
# Hinzufügen der Klassen und Methoden zum Diagramm
for (class_name in names(class_relations)) {
graph <- graph %>%
add_node(class_name, label = class_name)
for (method_name in names(class_relations[[class_name]])) {
method_id <- paste(class_name, method_name, sep = "_")
graph <- graph %>%
# add_node(paste(class_name, method_name, sep = "_"),
#          label = method_name, shape = ellipse) %>%
#  add_edge(class_name, paste(class_name, method_name, sep = "_"))
add_node(method_id, label = method_name) %>%
add_edge(class_name, method_id)  # Connect class to method
}
}
# graph <- grViz("digraph G {
#   graph [layout = dot]
#   node [shape = rectangle, style = filled, fillcolor = LightBlue]
#
#   # Klassen und ihre Methoden hinzufügen
#   ")
graph <- create_graph()
class_name
graph <- graph %>%
add_node(class_name, label = class_name)
names(class_relations[[class_name]])
method_name
method_id <- paste(class_name, method_name, sep = "_")
method_id
graph <- graph %>%
# add_node(paste(class_name, method_name, sep = "_"),
#          label = method_name, shape = ellipse) %>%
#  add_edge(class_name, paste(class_name, method_name, sep = "_"))
add_node(method_id, label = method_name) %>%
add_edge(class_name, method_id)  # Connect class to method
paste(method_name)
#method_id <- paste(class_name, method_name, sep = "_")
method_id <- paste(method_name)
graph <- graph %>%
# add_node(paste(class_name, method_name, sep = "_"),
#          label = method_name, shape = ellipse) %>%
#  add_edge(class_name, paste(class_name, method_name, sep = "_"))
add_node(method_id, label = method_name) %>%
add_edge(class_name, method_id)  # Connect class to method
graph
###############################################
#### Classdiagram
# Funktion zum Erstellen eines Diagramms
create_class_diagram <- function(class_relations) {
# graph <- grViz("digraph G {
#   graph [layout = dot]
#   node [shape = rectangle, style = filled, fillcolor = LightBlue]
#
#   # Klassen und ihre Methoden hinzufügen
#   ")
graph <- create_graph()
# Hinzufügen der Klassen und Methoden zum Diagramm
for (class_name in names(class_relations)) {
graph <- graph %>%
add_node(class_name, label = class_name)
for (method_name in names(class_relations[[class_name]])) {
#method_id <- paste(class_name, method_name, sep = "_")
method_id <- paste(method_name)
graph <- graph %>%
# add_node(paste(class_name, method_name, sep = "_"),
#          label = method_name, shape = ellipse) %>%
#  add_edge(class_name, paste(class_name, method_name, sep = "_"))
add_node(method_id, label = method_name) %>%
add_edge(class_name, method_id)  # Connect class to method
}
}
# Add classes and their methods to the diagram
# for (class_name in names(class_relations)) {
#   graph <- paste(graph, sprintf('  "%s";\n', class_name))  # Add class node
#
#   for (method_name in names(class_relations[[class_name]])) {
#     method_node <- paste(class_name, method_name, sep = "_")
#     graph <- paste(graph, sprintf('  "%s" [shape=ellipse, label="%s"];\n', method_node, method_name))  # Add method node
#     graph <- paste(graph, sprintf('  "%s" -> "%s";\n', class_name, method_node))  # Add edge from class to method
#   }
# }
# Add class relationships
# for (class_name in names(class_relations)) {
#   relations <- class_relations[[class_name]]
#   for (method_name in names(relations)) {
#     for (related_class in relations[[method_name]]) {
#       method_node <- paste(class_name, method_name, sep = "_")
#       graph <- paste(graph, sprintf('  "%s" -> "%s";\n', method_node, related_class))  # Add edge from method to related class
#     }
#   }
# }
graph <- paste(graph, "}")
return(graph)
}
class_diagram <- create_class_diagram(class_relations =class_relations)
data = c(aaaa,aaa,aaa)
data = c("aaaa","aaa","aaa")
data
as.data.frame(data)
as.data.frame(data) %>%  filter(data = "aaa")
library(tidyverse)
as.data.frame(data) %>%  filter(data = "aaa")
as.data.frame(data) %>%  filter(data == "aaa")
as.data.frame(data) |> filter(data == "aaa")
install.packages("cranlogs")
library(cranlogs)
cran_downloads("fuseMLR", from = "2025-01-01", to = "2025-11-10")
as.data.Frame(cran_downloads("fuseMLR", from = "2025-01-01", to = "2025-11-10"))
as.data.frame(cran_downloads("fuseMLR", from = "2025-01-01", to = "2025-11-10"))
table(as.data.frame(cran_downloads("fuseMLR", from = "2025-01-01", to = "2025-11-10")))
library(cranlogs)
cran_downloads("fuseMLR", from = "2025-01-01", to = "2025-11-01")
library(cranlogs)
cran_downloads("fuseMLR", from = "2025-01-01", to = "2025-11-01")
library(cranlogs)
test <- data.frame(cran_downloads("fuseMLR", from = "2025-01-01", to = "2025-11-01"))
test
sum(test$count)
??cranlogs
??cranlogs::cran_downloads
library(readr)
library(rstudioapi) # for path definition
library(dplyr)
library(tidyr)
library(ranger)
library(caret)
library(DescTools)
library(rio)
#library(tibble)
library(kableExtra)
library(janitor)
library(stringr)
library(UpSetR)
library(knitr)
library(kableExtra)
library(stringr)
library(purrr)
# Get current script directory
script_dir <- dirname(rstudioapi::getActiveDocumentContext()$path)
# Go two levels up
two_levels_up <- dirname(dirname(script_dir))
# build the full path to the data folder
# RA-MAP_Daten
subproject_dir <- file.path(two_levels_up, "RA-MAP_Daten")
library(usethis)
create_package("C:/Users/bleskina/mywork/R-Pkg/SimFramework/R-pkg")
library(usethis)
create_package("C:/Users/bleskina/mywork/R-Pkg/SimFramework/SimData")
@importFrom MASS mvrnorm
library(devtools)
document()
getwd()
setwd("C:/Users/bleskina/mywork/R-Pkg/SimFramework/SimData")
getwd
getwd()
library(devtools)
document()
use_testthat()
library(devtools)
use_testthat()
library(usethis)
use_testthat()
install.packages("usethis")
install.packages("usethis")
library(usethis)
use_testthat()
use_testthat()
library(testthat)
library(SimData)
#' @return A named list of covariance matrices, each corresponding to a block.
#' @examples
#' block_info <- data.frame(
#'   block_id = c("A", "B", "C"),
#'   block_size = c(4, 6, 3),
#'   rho = c(0.4, 0.2, 0.6)
#' )
#' blocks <- define_blocks(block_info)
#' str(blocks)
#' @export
define_blocks <- function(block_info) {
if (!all(c("block_id", "block_size", "rho") %in% colnames(block_info))) {
stop("block_info must contain columns: block_id, block_size, and rho.")
}
blocks <- vector("list", nrow(block_info))
names(blocks) <- block_info$block_id
for (i in 1:nrow(block_info)) {
size <- block_info$block_size[i]
rho <- block_info$rho[i]
Sigma <- matrix(rho, nrow = size, ncol = size)
diag(Sigma) <- 1
blocks[[i]] <- Sigma
}
return(blocks)
}
test_that("define_blocks erstellt korrekte Matrizen", {
block_info <- data.frame(block_id = c("A","B"),
block_size = c(2,3),
rho = c(0.5,0.2))
blocks <- define_blocks(block_info)
expect_equal(length(blocks), 2)
expect_equal(dim(blocks$A), c(2,2))
expect_equal(blocks$B[1,2], 0.2)
})
block_info <- data.frame(block_id = c("A","B"),
block_size = c(2,3),
rho = c(0.5,0.2))
block_info
blocks <- define_blocks(block_info)
blocks
expect_equal(length(blocks), 2)
length(blocks)
dim(blocks$A)
blocks$A
blocks$B[1,2]
blocks <- list(A = matrix(c(1,0.3,0.3,1), 2, 2))
blocks
n = 10
predictors <- list()
seq_along(blocks)
i = 1
block_data <- MASS::mvrnorm(n = n, mu = rep(0, ncol(block)), Sigma = block)
block <- blocks[[i]]
block
block_data <- MASS::mvrnorm(n = n, mu = rep(0, ncol(block)), Sigma = block)
block_data
colnames(block_data) <- paste0("var_", i, "_", 1:ncol(block))
predictors[[i]] <- block_data
predictor
predictors
#' @param blocks List of covariance matrices (output from \code{define_blocks()}).
#' @param n Integer. Number of observations to simulate per block.
#'
#' @return A numeric matrix of simulated predictors.
#' @examples
#' blocks <- define_blocks(2, 3, 0.3)
#' X <- simulate_predictors(blocks, n = 100)
#' head(X)
#' @importFrom MASS mvrnorm
#' @export
simulate_predictors <- function(blocks, n) {
predictors <- list()
for (i in seq_along(blocks)) {
block <- blocks[[i]]
block_data <- MASS::mvrnorm(n = n, mu = rep(0, ncol(block)), Sigma = block)
colnames(block_data) <- paste0("var_", i, "_", 1:ncol(block))
predictors[[i]] <- block_data
}
data_matrix <- do.call(cbind, predictors)
return(data_matrix)
}
X <- simulate_predictors(blocks, n = 10)
X
expect_equal(dim(X), c(10,2))
blocks
X <- matrix(rnorm(20), 10, 2)
X
block_info <- data.frame(block_id = "A", block_size = 2, effect_size = 1)
block_info
# Derive block-to-column mapping
block_indices <- split(
1:ncol(X),
rep(block_info$block_id, times = block_info$block_size))
block_indices
linear_predictor <- rep(0, nrow(X))
for (i in seq_len(nrow(block_info))) {
block_id <- block_info$block_id[i]
beta <- block_info$effect_size[i]
if (beta != 0) {
cols <- block_indices[[block_id]]
linear_predictor <- linear_predictor +
as.vector(X[, cols, drop = FALSE] %*% rep(beta, length(cols)))
}
}
prob <- 1 / (1 + exp(-linear_predictor))
prob
rbinom(n = nrow(X), size = 1, prob = prob)
y <- simulate_outcome(X, block_info)
#' set.seed(123)
#' X <- matrix(rnorm(1000), ncol = 10)
#' block_info <- data.frame(
#'   block_id = c("A", "B"),
#'   block_size = c(5, 5),
#'   effect_size = c(1, 0.5)
#' )
#' y <- simulate_outcome(X, block_info)
#' table(y)
#' @export
simulate_outcome <- function(X, block_info) {
if (!all(c("block_id", "block_size", "effect_size") %in% colnames(block_info))) {
stop("block_info must contain columns: block_id, block_size, and effect_size.")
}
# Derive block-to-column mapping
block_indices <- split(
1:ncol(X),
rep(block_info$block_id, times = block_info$block_size))
linear_predictor <- rep(0, nrow(X))
for (i in seq_len(nrow(block_info))) {
block_id <- block_info$block_id[i]
beta <- block_info$effect_size[i]
if (beta != 0) {
cols <- block_indices[[block_id]]
linear_predictor <- linear_predictor +
as.vector(X[, cols, drop = FALSE] %*% rep(beta, length(cols)))
}
}
prob <- 1 / (1 + exp(-linear_predictor))
rbinom(n = nrow(X), size = 1, prob = prob)
}
test_that("simulate_outcome returns binary outcomes", {
X <- matrix(rnorm(20), 10, 2)
block_info <- data.frame(block_id = "A", block_size = 2, effect_size = 1)
y <- simulate_outcome(X, block_info)
expect_true(all(y %in% c(0,1)))
})
test()
devtools::test()
devtools::test()
check()
devtools::ckeck()
devtools::check()
devtools::check()
devtools::document()
devtools::check()
devtools::document()
devtools::check()
usethis::use_mit_license("Silke Szymczak")
devtools::check()
build()
devtools::build()
library(pkgdown)
build_site()
install.packages("C:/Users/bleskina/mywork/R-Pkg/SimFramework/SimData_0.1.0.tar.gz", repos = NULL, type = "source")
library(SimData)
